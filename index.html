<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agro Total - Tienda Virtual</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Playfair+Display:wght@700&family=Roboto+Condensed:wght@700&display=swap" rel="stylesheet">
    <!-- Incluir SDK de Stripe para procesamiento de pagos -->
    <script src="https://js.stripe.com/v3/"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .header-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 1200px;
        }

        .titulo-principal {
            background-color: #CC7722;
            padding: 15px 30px;
            text-align: center;
            margin-bottom: 10px;
            font-family: 'Montserrat', sans-serif;
            font-size: 32px;
            color: #000;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            width: fit-content;
            max-width: 90%;
        }

        .subtitulo {
            background-color: #FFD700;
            padding: 12px 25px;
            text-align: center;
            margin-bottom: 10px;
            font-family: 'Playfair Display', serif;
            font-size: 26px;
            color: #000;
            font-style: italic;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            width: fit-content;
            max-width: 90%;
        }

        .contacto {
            background-color: #0047AB;
            padding: 12px 25px;
            text-align: center;
            margin-bottom: 20px;
            font-family: 'Roboto Condensed', sans-serif;
            font-size: 22px;
            color: #FFF;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            width: fit-content;
            max-width: 90%;
        }

        .galeria-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .imagen-card {
            position: relative;
            overflow: hidden;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            background-color: white;
            transition: transform 0.3s ease;
        }

        .imagen-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
        }

        .imagen-container {
            height: 200px;
            background-color: #eee;
            overflow: hidden;
        }

        .imagen-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .imagen-card:hover .imagen-container img {
            transform: scale(1.05);
        }

        .descripcion {
            padding: 15px;
            text-align: center;
            color: #333;
            font-size: 14px;
            line-height: 1.4;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .precio {
            font-weight: bold;
            font-size: 18px;
            margin: 5px 0;
            color: #2c3e50;
        }

        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #666;
        }

        .error-message {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #d32f2f;
            text-align: center;
            width: 100%;
            padding: 0 10px;
        }
        
        .links-section {
            max-width: 1200px;
            margin: 30px auto;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .link-item {
            margin-bottom: 15px;
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            flex-direction: column;
        }
        
        .link-item:last-child {
            border-bottom: none;
        }
        
        .link-description {
            margin-bottom: 10px;
            color: #555;
            font-size: 16px;
        }
        
        .link-url {
            margin-bottom: 10px;
            color: #666;
            font-size: 14px;
            word-break: break-all;
        }
        
        .btn {
            display: inline-block;
            padding: 12px 24px;
            border-radius: 6px;
            text-decoration: none;
            color: white;
            font-weight: bold;
            text-align: center;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
            font-size: 15px;
            width: 220px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin: 5px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0,0,0,0.15);
        }
        
        .btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        
        .btn-info {
            background: linear-gradient(135deg, #1abc9c, #16a085);
        }
        
        .btn-semaforo {
            animation: cambioColor 4s infinite;
        }
        
        @keyframes cambioColor {
            0% { background: linear-gradient(135deg, #e74c3c, #c0392b); }
            33% { background: linear-gradient(135deg, #e74c3c, #c0392b); }
            34% { background: linear-gradient(135deg, #f39c12, #e67e22); }
            66% { background: linear-gradient(135deg, #f39c12, #e67e22); }
            67% { background: linear-gradient(135deg, #2ecc71, #27ae60); }
            100% { background: linear-gradient(135deg, #2ecc71, #27ae60); }
        }
        
        .btn-container {
            margin-top: 10px;
        }
        
        /* Estilos para el footer de copyright */
        .copyright-footer {
            margin-top: 40px;
            padding: 15px;
            text-align: center;
            width: 100%;
            background-color: #333;
            color: #FFF;
            font-family: 'Roboto Condensed', sans-serif;
            font-size: 16px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        /* Nuevos estilos para la tienda */
        .carrito-container {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            z-index: 1000;
        }

        .carrito-icono {
            font-size: 24px;
            cursor: pointer;
            position: relative;
        }

        .carrito-contador {
            position: absolute;
            top: -10px;
            right: -10px;
            background-color: #e74c3c;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
        }

        .carrito-items {
            display: none;
            position: absolute;
            top: 50px;
            right: 0;
            background-color: white;
            width: 300px;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            padding: 15px;
            max-height: 400px;
            overflow-y: auto;
        }

        .carrito-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .carrito-total {
            font-weight: bold;
            margin-top: 10px;
            text-align: right;
        }

        .checkout-form {
            display: none;
            max-width: 600px;
            margin: 30px auto;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }

        .payment-form {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 8px;
        }

        #card-element {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background-color: white;
        }

        .producto-agregado {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #2ecc71;
            color: white;
            padding: 10px 15px;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            display: none;
            z-index: 1000;
        }

        .cantidad-selector {
            margin: 10px 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .cantidad-selector button {
            width: 30px;
            height: 30px;
            background-color: #0047AB;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
        }

        .cantidad-selector input {
            width: 40px;
            text-align: center;
            margin: 0 5px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="header-container">
        <h1 class="titulo-principal">Agro Total - parte de Grupo MultiPC</h1>
        <h2 class="subtitulo">desde 1,998 innovando para el desarrollo</h2>
        <h3 class="contacto">Whatsapp +502 4376-9408 Pbx 6633-6986</h3>
    </div>

    <!-- Carrito de compras -->
    <div class="carrito-container">
        <div class="carrito-icono" onclick="toggleCarrito()">
            🛒 <span class="carrito-contador" id="carrito-contador">0</span>
        </div>
        <div class="carrito-items" id="carrito-items">
            <h3>Tu Carrito</h3>
            <div id="carrito-lista"></div>
            <div class="carrito-total">Total: Q <span id="carrito-total">0.00</span></div>
            <button class="btn btn-success" onclick="mostrarCheckout()">Finalizar Compra</button>
            <button class="btn btn-danger" onclick="vaciarCarrito()">Vaciar Carrito</button>
        </div>
    </div>
    
    <div class="galeria-container" id="galeria">
        <!-- Las imágenes se generarán dinámicamente con JavaScript -->
    </div>
    
    <div class="links-section">
        <h2>REGISTRO PARA RECIBIR MAS INFORMACIÓN</h2>
        
        <div class="link-item">
            <p class="link-description">Regístrate ahora y obtén un Descuento Adicional"</p>
            <span class="link-url">https://forms.gle/DHCokcjf3dG1JudN8</span>
            <div class="btn-container">
                <a href="https://forms.gle/DHCokcjf3dG1JudN8" target="_blank" class="btn btn-primary">Acceder al formulario</a>
            </div>
        </div>
    </div>

    <!-- Formulario de checkout -->
    <div class="checkout-form" id="checkout-form">
        <h2>Finalizar Compra</h2>
        
        <form id="form-datos-cliente">
            <h3>Datos de Envío</h3>
            <div class="form-group">
                <label for="nombre">Nombre completo:</label>
                <input type="text" id="nombre" required>
            </div>
            <div class="form-group">
                <label for="direccion">Dirección:</label>
                <input type="text" id="direccion" required>
            </div>
            <div class="form-group">
                <label for="ciudad">Ciudad:</label>
                <input type="text" id="ciudad" required>
            </div>
            <div class="form-group">
                <label for="telefono">Teléfono:</label>
                <input type="tel" id="telefono" required>
            </div>
            <div class="form-group">
                <label for="email">Correo electrónico:</label>
                <input type="email" id="email" required>
            </div>
            
            <h3>Método de Pago</h3>
            <div class="payment-form">
                <div class="form-group">
                    <label>Tarjeta de crédito o débito:</label>
                    <div id="card-element"></div>
                </div>
            </div>
            
            <button type="submit" class="btn btn-success">Pagar ahora</button>
            <button type="button" class="btn btn-danger" onclick="ocultarCheckout()">Cancelar</button>
        </form>
    </div>

    <!-- Notificación de producto agregado -->
    <div class="producto-agregado" id="producto-agregado">
        Producto agregado al carrito
    </div>

    <!-- Footer con copyright añadido al final -->
    <div class="copyright-footer">
        © 2025 GRUPO MULTI-PC - Todos los derechos reservados
    </div>

    <script>
        // Configuración de Stripe (reemplaza con tu clave pública)
        const stripe = Stripe('pk_test_51P9h6pKzqU2hKZ1Z7Z...'); // Clave de prueba
        const elements = stripe.elements();
        const cardElement = elements.create('card');
        cardElement.mount('#card-element');

        document.addEventListener('DOMContentLoaded', function() {
            const galeria = document.getElementById('galeria');
            const baseUrl = 'https://grupomultipc.github.io/agrototal2/';
            const totalImagenes = 12;

            // Array con descripciones y precios para cada producto
            const productos = [
                { 
                    descripcion: "Millar de Pilon de Tomate p52",
                    precio: 1100,
                    id: "prod-001"
                },
                { 
                    descripcion: "Millar de pilon de Pimiento",
                    precio: 1100,
                    id: "prod-002"
                },
                { 
                    descripcion: "Malla Agril para agricultura",
                    precio: 450,
                    id: "prod-003"
                },
                { 
                    descripcion: "Saran en varios calibres",
                    precio: 380,
                    id: "prod-004"
                },
                { 
                    descripcion: "Bandejas para Pilones",
                    precio: 250,
                    id: "prod-005"
                },
                { 
                    descripcion: "Sustratos para Pilones y hidroponia",
                    precio: 320,
                    id: "prod-006"
                },
                { 
                    descripcion: "Microaspersores para riego por goteo",
                    precio: 180,
                    id: "prod-007"
                },
                { 
                    descripcion: "Sistemas Solares Basicos para Agricultura",
                    precio: 2850,
                    id: "prod-008"
                },
                { 
                    descripcion: "Temporizadores Automaticos de llave de paso de agua",
                    precio: 420,
                    id: "prod-009"
                },
                { 
                    descripcion: "Suministros para Hidroponia",
                    precio: 560,
                    id: "prod-010"
                },
                { 
                    descripcion: "Suministros para Acuicultura",
                    precio: 890,
                    id: "prod-011"
                },
                { 
                    descripcion: "Medidores para Tierra y para Agua",
                    precio: 650,
                    id: "prod-012"
                }
            ];

            // Inicializar carrito
            let carrito = JSON.parse(localStorage.getItem('carrito')) || [];
            actualizarCarrito();

            // Crear contenedores para cada producto
            for (let i = 1; i <= totalImagenes; i++) {
                const nombreArchivo = `imagen${i}.jpg`;
                const imagenUrl = baseUrl + nombreArchivo;
                const producto = productos[i-1];
                
                // Crear la tarjeta completa
                const card = document.createElement('div');
                card.className = 'imagen-card';

                // Contenedor de la imagen
                const container = document.createElement('div');
                container.className = 'imagen-container';

                const loading = document.createElement('div');
                loading.className = 'loading';
                loading.textContent = `Cargando imagen ${i}...`;

                const img = document.createElement('img');
                img.src = imagenUrl;
                img.alt = `Imagen ${i}`;
                img.loading = 'lazy';
                
                // Crear elemento para la descripción
                const descripcion = document.createElement('div');
                descripcion.className = 'descripcion';
                
                // Precio del producto
                const precio = document.createElement('div');
                precio.className = 'precio';
                precio.textContent = `Q${producto.precio}`;
                
                // Selector de cantidad
                const cantidadContainer = document.createElement('div');
                cantidadContainer.className = 'cantidad-selector';
                
                const btnMenos = document.createElement('button');
                btnMenos.textContent = '-';
                btnMenos.onclick = function() {
                    const input = cantidadContainer.querySelector('input');
                    if (input.value > 1) input.value = parseInt(input.value) - 1;
                };
                
                const inputCantidad = document.createElement('input');
                inputCantidad.type = 'number';
                inputCantidad.min = '1';
                inputCantidad.value = '1';
                inputCantidad.id = `cantidad-${producto.id}`;
                
                const btnMas = document.createElement('button');
                btnMas.textContent = '+';
                btnMas.onclick = function() {
                    const input = cantidadContainer.querySelector('input');
                    input.value = parseInt(input.value) + 1;
                };
                
                cantidadContainer.appendChild(btnMenos);
                cantidadContainer.appendChild(inputCantidad);
                cantidadContainer.appendChild(btnMas);
                
                // Botón para agregar al carrito
                const btnAgregar = document.createElement('button');
                btnAgregar.className = 'btn btn-success';
                btnAgregar.textContent = 'Agregar al carrito';
                btnAgregar.onclick = function() {
                    const cantidad = parseInt(document.getElementById(`cantidad-${producto.id}`).value);
                    agregarAlCarrito(producto, cantidad);
                    mostrarNotificacion();
                };
                
                descripcion.textContent = producto.descripcion;
                descripcion.appendChild(precio);
                descripcion.appendChild(cantidadContainer);
                descripcion.appendChild(btnAgregar);

                // Manejar carga exitosa
                img.onload = function() {
                    loading.style.display = 'none';
                };

                // Manejar errores
                img.onerror = function() {
                    loading.textContent = '';
                    loading.className = 'error-message';
                    loading.innerHTML = `Imagen ${i} no encontrada<br><small>${nombreArchivo}</small>`;
                    img.style.display = 'none';
                };

                container.appendChild(loading);
                container.appendChild(img);
                
                card.appendChild(container);
                card.appendChild(descripcion);
                
                galeria.appendChild(card);
            }
            
            // Configurar el formulario de pago
            document.getElementById('form-datos-cliente').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                // Deshabilitar el botón de pago para evitar múltiples clics
                const submitButton = this.querySelector('button[type="submit"]');
                submitButton.disabled = true;
                submitButton.textContent = 'Procesando...';
                
                try {
                    // Crear token de la tarjeta
                    const { token, error } = await stripe.createToken(cardElement);
                    
                    if (error) {
                        alert('Error: ' + error.message);
                        submitButton.disabled = false;
                        submitButton.textContent = 'Pagar ahora';
                        return;
                    }
                    
                    // Obtener datos del cliente
                    const cliente = {
                        nombre: document.getElementById('nombre').value,
                        direccion: document.getElementById('direccion').value,
                        ciudad: document.getElementById('ciudad').value,
                        telefono: document.getElementById('telefono').value,
                        email: document.getElementById('email').value,
                        token: token.id
                    };
                    
                    // Enviar datos al servidor (aquí simulado)
                    console.log('Datos enviados:', {
                        cliente: cliente,
                        carrito: carrito,
                        total: calcularTotal()
                    });
                    
                    // Simular éxito en el pago
                    alert('¡Pago procesado con éxito! Su pedido ha sido registrado.');
                    vaciarCarrito();
                    ocultarCheckout();
                    
                } catch (error) {
                    alert('Error al procesar el pago: ' + error.message);
                }
                
                submitButton.disabled = false;
                submitButton.textContent = 'Pagar ahora';
            });
        });

        // Funciones del carrito
        function agregarAlCarrito(producto, cantidad) {
            const itemExistente = carrito.find(item => item.id === producto.id);
            
            if (itemExistente) {
                itemExistente.cantidad += cantidad;
            } else {
                carrito.push({
                    id: producto.id,
                    descripcion: producto.descripcion,
                    precio: producto.precio,
                    cantidad: cantidad
                });
            }
            
            localStorage.setItem('carrito', JSON.stringify(carrito));
            actualizarCarrito();
        }

        function eliminarDelCarrito(id) {
            carrito = carrito.filter(item => item.id !== id);
            localStorage.setItem('carrito', JSON.stringify(carrito));
            actualizarCarrito();
        }

        function vaciarCarrito() {
            carrito = [];
            localStorage.setItem('carrito', JSON.stringify(carrito));
            actualizarCarrito();
            toggleCarrito(false);
        }

        function actualizarCarrito() {
            const carritoLista = document.getElementById('carrito-lista');
            const carritoTotal = document.getElementById('carrito-total');
            const carritoContador = document.getElementById('carrito-contador');
            
            carritoLista.innerHTML = '';
            let total = 0;
            let totalItems = 0;
            
            carrito.forEach(item => {
                const itemTotal = item.precio * item.cantidad;
                total += itemTotal;
                totalItems += item.cantidad;
                
                const div = document.createElement('div');
                div.className = 'carrito-item';
                div.innerHTML = `
                    <div>${item.descripcion} x${item.cantidad}</div>
                    <div>Q${itemTotal.toFixed(2)} <button onclick="eliminarDelCarrito('${item.id}')">❌</button></div>
                `;
                
                carritoLista.appendChild(div);
            });
            
            carritoTotal.textContent = total.toFixed(2);
            carritoContador.textContent = totalItems;
        }

        function toggleCarrito(mostrar) {
            const carritoItems = document.getElementById('carrito-items');
            if (typeof mostrar === 'undefined') {
                mostrar = carritoItems.style.display !== 'block';
            }
            carritoItems.style.display = mostrar ? 'block' : 'none';
        }

        function mostrarCheckout() {
            if (carrito.length === 0) {
                alert('El carrito está vacío');
                return;
            }
            
            document.getElementById('checkout-form').style.display = 'block';
            toggleCarrito(false);
        }

        function ocultarCheckout() {
            document.getElementById('checkout-form').style.display = 'none';
        }

        function calcularTotal() {
            return carrito.reduce((total, item) => total + (item.precio * item.cantidad), 0);
        }

        function mostrarNotificacion() {
            const notificacion = document.getElementById('producto-agregado');
            notificacion.style.display = 'block';
            
            setTimeout(() => {
                notificacion.style.display = 'none';
            }, 2000);
        }
    </script>
</body>
</html>